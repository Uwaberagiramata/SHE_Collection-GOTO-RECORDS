# SHE_Collection-GOTO-RECORDS
# PL/SQL â€” Collections, Records, and GOTO

This repository demonstrates a clear, assessable problem that exercises PL/SQL **Collections**, **Records**, and **GOTO** statements. It is designed as an instructor-style assignment with source code, schema, sample data, tests, and documentation.

---

## Project goal / Problem definition

**Build a small Order Processing module** that:

* Reads *pending orders* from simple `orders` and `order_items` tables.
* Uses **PL/SQL Collections** to cache product prices and compute order totals in-memory before committing.
* Uses **PL/SQL Records** to hold single-order data (header) and item rows.
* Demonstrates a purposeful use of **GOTO** to show alternate error-recovery flow (explicit: label-driven jump to cleanup/error handler). The code will explain why GOTO is normally discouraged but included for assessment.
* Produces an execution report (rows processed, orders committed, orders skipped), and updates `product.stock` as orders are processed.


## Code: full contents

<details>
<summary><strong>sql/schema.sql</strong></summary>

```sql
-- schema.sql
-- DROP existing objects if needed (uncomment in dev)
-- DROP TABLE order_items CASCADE CONSTRAINTS; ...

CREATE TABLE customers (
  customer_id   NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name          VARCHAR2(100) NOT NULL,
  email         VARCHAR2(150)
);

CREATE TABLE products (
  product_id    NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name          VARCHAR2(100) NOT NULL,
  price         NUMBER(10,2) NOT NULL,
  stock         NUMBER NOT NULL
);

CREATE TABLE orders (
  order_id      NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  customer_id   NUMBER REFERENCES customers(customer_id),
  order_date    DATE DEFAULT SYSDATE,
  status        VARCHAR2(20) DEFAULT 'PENDING', -- PENDING/COMPLETED/SKIPPED
  total_amount  NUMBER(12,2)
);

CREATE TABLE order_items (
  order_item_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  order_id      NUMBER REFERENCES orders(order_id) ON DELETE CASCADE,
  product_id    NUMBER REFERENCES products(product_id),
  quantity      NUMBER NOT NULL,
  unit_price    NUMBER(10,2) -- cached price at time of order
);

COMMIT;
```

</details>

<details>
<summary><strong>sql/data.sql</strong></summary>

```sql
-- data.sql: sample data
INSERT INTO customers (name,email) VALUES ('Alice Johnson','alice@example.com');
INSERT INTO customers (name,email) VALUES ('Bob Kamanzi','bob@example.com');

INSERT INTO products (name,price,stock) VALUES ('Widget A', 12.50, 10);
INSERT INTO products (name,price,stock) VALUES ('Widget B', 5.25, 2);
INSERT INTO products (name,price,stock) VALUES ('Widget C', 99.99, 1);

-- Orders: one normal, one that will cause insufficient stock, and one to be skipped
INSERT INTO orders (customer_id, order_date, status) VALUES (1, SYSDATE, 'PENDING');
INSERT INTO order_items (order_id, product_id, quantity, unit_price) VALUES (1, 1, 2, 12.50);
INSERT INTO order_items (order_id, product_id, quantity, unit_price) VALUES (1, 2, 1, 5.25);

INSERT INTO orders (customer_id, order_date, status) VALUES (2, SYSDATE, 'PENDING');
INSERT INTO order_items (order_id, product_id, quantity, unit_price) VALUES (2, 3, 2, 99.99); -- will exceed stock

INSERT INTO orders (customer_id, order_date, status) VALUES (1, SYSDATE, 'PENDING');
INSERT INTO order_items (order_id, product_id, quantity, unit_price) VALUES (3, 2, 1, 5.25);

COMMIT;
```
```sql
SET SERVEROUTPUT ON;

DECLARE
  TYPE customer_rec IS RECORD (
    name customers.name%TYPE,
    email customers.email%TYPE
  );

  TYPE customer_tab IS TABLE OF customer_rec;
  customers_list customer_tab := customer_tab();

  i NUMBER := 1;
BEGIN
  -- Load customers into collection
  FOR rec IN (SELECT name, email FROM customers) LOOP
    customers_list.EXTEND;
    customers_list(customers_list.LAST).name := rec.name;
    customers_list(customers_list.LAST).email := rec.email;
  END LOOP;

  <<display_loop>>
  IF i > customers_list.COUNT THEN
    GOTO finish;
  END IF;

  DBMS_OUTPUT.PUT_LINE('Customer ' || i || ': ' || customers_list(i).name || ' - ' || customers_list(i).email);
  i := i + 1;
  GOTO display_loop;

  <<finish>>
  DBMS_OUTPUT.PUT_LINE('--- Done displaying customers ---');
END;
/
```

</details>        
</details>

---
**OUTPUT**
<img width="1366" height="718" alt="Screenshot 2025-11-11 184411" src="https://github.com/user-attachments/assets/601bf013-5648-4838-ad59-fe35b942c500" />



